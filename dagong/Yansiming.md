#  SQL数据库中有以下两表：

表A

| code        | date     | price |
| ----------- | -------- | ----- |
| ‘000001.SZ’ | 20200821 | 14.45 |
| ‘000002.SZ’ | 20200820 |       |
| ‘000002.SZ’ | 20200819 | 27.44 |

 

表B

| code        | industry | date     |
| ----------- | -------- | -------- |
| ‘000001.SZ’ | 银行     | 20200821 |
| ‘000001.SZ’ | 银行     | 20200820 |
| ‘000002.SZ’ | 房地产   | 20200819 |

 

##         请写出输出表C的样式的SQL查询语句；

表C：

| code        | date     | price | industry |
| ----------- | -------- | ----- | -------- |
| ‘000001.SZ’ | 20200821 | 14.45 | 银行     |
| ‘000002.SZ’ | 20200820 |       |          |
| ‘000002.SZ’ | 20200819 | 27.44 | 房地产   |

```sql
select a.code, a.date, a.price, b.industry from A as a
left join B as b
on a.code = b.code
and a.date = b.date
```

 

##     请写出输出表D的样式的SQL查询语句。

表D：

| code        | industry | date     | price |
| ----------- | -------- | -------- | ----- |
| ‘000001.SZ’ | 银行     | 20200821 | 14.45 |
| ‘000001.SZ’ | 银行     | 20200820 |       |

```sql
select * from
(select a.code, b.industry, a.date, a.price from A as a
inner join B as b
on a.code = b.code
and a.date = b.date
)as D
where D.code = ‘000001.SZ’
```



 

# 编写程序将序列 25, 12, 4, 58, 7, 20, 4, 70 按照从小到大的顺序排序。

 ```R
a = as.numeric(strsplit("25, 12, 4, 58, 7, 20, 4, 70", ",")[[1]])
sort(a, decreasing = F)
# 4  4  7 12 20 25 58 70
 ```



# 编写程序计算1+1\*2+1\*2\*3+1\*2\*3\*4+…+1\*2\*3\*4\*5\*6\*7\*8\*9\*10的数值。



```R
t = {};
for (i in 1:10){
  t =  sum(cumprod(1:i))
};
cat(t)
# 4037913
```



 

# 编写程序，实现用1到100间的全部自然0数输出一个10行10列的矩阵，使得矩阵的每一行、每一列和对角线之和均相等。





```R
sum(1:100)/10 # 每行/列的和应该为: 505

a = (seq(1, 100, 11))
df = matrix(1,11,10)
df[1,] = rep(c(1, 0), 5)
df[2,] = a
df_even = df[, df[1, ] == 0]
df_oddd = df[, df[1, ] == 1]

for (i in 3:11){
  df_even[i, ] = df_even[i-1, ]-1
};df_even

for (i in 3:11){
  df_oddd[i, ] = df_oddd[i-1, ]+1
};df_oddd

df_2 = cbind(df_even, df_oddd)
df_2 = df_2[,order(df_2[2, ])]
df_2 = data.frame(df_2[2:11, ])
df_2
```

| X1<dbl> | X2<dbl> | X3<dbl> | X4<dbl> | X5<dbl> | X6<dbl> | X7<dbl> | X8<dbl> | X9<dbl> | X10<dbl> |
| ------: | ------: | ------: | ------: | ------: | ------: | ------: | ------: | ------: | -------: |
|       1 |      12 |      23 |      34 |      45 |      56 |      67 |      78 |      89 |      100 |
|       2 |      11 |      24 |      33 |      46 |      55 |      68 |      77 |      90 |       99 |
|       3 |      10 |      25 |      32 |      47 |      54 |      69 |      76 |      91 |       98 |
|       4 |       9 |      26 |      31 |      48 |      53 |      70 |      75 |      92 |       97 |
|       5 |       8 |      27 |      30 |      49 |      52 |      71 |      74 |      93 |       96 |
|       6 |       7 |      28 |      29 |      50 |      51 |      72 |      73 |      94 |       95 |
|       7 |       6 |      29 |      28 |      51 |      50 |      73 |      72 |      95 |       94 |
|       8 |       5 |      30 |      27 |      52 |      49 |      74 |      71 |      96 |       93 |
|       9 |       4 |      31 |      26 |      53 |      48 |      75 |      70 |      97 |       92 |
|      10 |       3 |      32 |      25 |      54 |      47 |      76 |      69 |      98 |       91 |

